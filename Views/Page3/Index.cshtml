@{
  ViewData["Title"] = "Treeview - Extended UI";
}
@section VendorStyles {
  <link rel="stylesheet" href="~/vendor/libs/jstree/jstree.css" />
}
@section VendorScripts {
  <script src="~/vendor/libs/jstree/jstree.js"></script>
}
@section PageScripts {
  <script src="~/js/extended-ui-treeview.js"></script>
}
@* ************** Content ************** *@

@using Syncfusion.EJ2

<link href="https://cdn.syncfusion.com/ej2/22.1.34/material.css" rel="stylesheet" />
<script src="https://cdn.syncfusion.com/ej2/22.1.34/dist/ej2.min.js"></script>



@*<div class="row">
  <!-- Context Menu -->
  <div class="col-md-6 col-12">
    <div class="card mb-6">
      <h5 class="card-header">Context Menu</h5>
      <div class="card-body">
        <div id="jstree-context-menu" class="overflow-auto"></div>
      </div>
    </div>
  </div>*@
<!-- /Context Menu -->
<!-- Drag & Drop -->
<div class="row full-height">

  <!-- Tree View Section -->
  <div class="col-md-4 col-12">
    <div class="card mb-6">
      <h5 class="card-header">Tree-View</h5>
      <div class="card-body">
        <div id="jstree-drag-drop" class="overflow-auto"></div>
      </div>
    </div>
  </div>

  <!-- Word Processor Section -->
  <div class="col-md-8 col-12">
    <div class="card mb-6">
      <h5 class="card-header d-flex justify-content-between align-items-center">
        <span>Word Processor</span>
        <button class="btn btn-sm btn-primary" onclick="showEditor()">Edit</button>
      </h5>
      <div class="card-body">
        <ejs-documenteditor id="container" height='850px'></ejs-documenteditor>
      </div>
    </div>
  </div>
</div>
<!-- Add this before the dialog component -->
<div id="dialog-target"></div>


<!-- Syncfusion Dialog -->
<ejs-dialog id="docEditorDialog" header="Word Processor" isModal=true visible="false" showCloseIcon="true" width="80%"
  height="80%" target="#dialog-target" cssClass="custom-editor-dialog">
  <e-content-template height="80%">
    <div style="height:80%; width:80%;">
      <!-- Container must fill height -->
      <div style="height:80%; width:80%;">
        <ejs-documenteditorcontainer id="docEditor" enableToolbar=true height="80%" serviceUrl="/api/DocumentEditor/"
          zIndex="3000" created="onEditorCreated">
        </ejs-documenteditorcontainer>
      </div>
    </div>
  </e-content-template>
</ejs-dialog>

<script>
  function showEditor() {
    var dialog = document.getElementById("docEditorDialog").ej2_instances[0];
    if (dialog) {
      dialog.show();

      setTimeout(function () {
        var editor = document.getElementById("docEditor").ej2_instances?.[0];
        if (editor) {
          console.log("Resizing editor...");
          editor.resize();
        } else {
          console.warn("Editor instance not found");
        }
      }, 300);
    }
  }
  function onEditorCreated() {
    console.log("Document editor is ready.");
  }
</script>

<style>
  html,
  body {
    height: 100vh;
    margin: 0;

  }

  #dialog-target {
    height: 100vh;
  }

  .custom-editor-dialog .e-dlg-content {
    height: calc(100% - 50px);
    /* Adjusts for dialog header height */
    padding: 0 !important;
    overflow: hidden;
  }

  #docEditor {
    height: 100% !important;
  }
</style>
